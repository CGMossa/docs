<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stan Functions Reference</title>
  <meta name="description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Stan Functions Reference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stan Functions Reference" />
  
  <meta name="twitter:description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language." />
  

<meta name="author" content="Stan Development Team">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="simplex-distributions.html">
<link rel="next" href="correlation-matrix-distributions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="../stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em">Stan Functions Reference</li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li><a href="built-in-functions.html#built-in-functions"><i style="font-size: 110%; color:#990017;">Built-In Functions</i></a></li>
<li class="chapter" data-level="1" data-path="void-functions.html"><a href="void-functions.html"><i class="fa fa-check"></i><b>1</b> Void Functions</a></li>
<li class="chapter" data-level="2" data-path="integer-valued-basic-functions.html"><a href="integer-valued-basic-functions.html"><i class="fa fa-check"></i><b>2</b> Integer-Valued Basic Functions</a></li>
<li class="chapter" data-level="3" data-path="real-valued-basic-functions.html"><a href="real-valued-basic-functions.html"><i class="fa fa-check"></i><b>3</b> Real-Valued Basic Functions</a></li>
<li class="chapter" data-level="4" data-path="array-operations.html"><a href="array-operations.html"><i class="fa fa-check"></i><b>4</b> Array Operations</a></li>
<li class="chapter" data-level="5" data-path="matrix-operations.html"><a href="matrix-operations.html"><i class="fa fa-check"></i><b>5</b> Matrix Operations</a></li>
<li class="chapter" data-level="6" data-path="sparse-matrices.html"><a href="sparse-matrices.html"><i class="fa fa-check"></i><b>6</b> Sparse Matrix Operations</a></li>
<li class="chapter" data-level="7" data-path="mixed-operations.html"><a href="mixed-operations.html"><i class="fa fa-check"></i><b>7</b> Mixed Operations</a></li>
<li class="chapter" data-level="8" data-path="compound-arithmetic-and-assignment.html"><a href="compound-arithmetic-and-assignment.html"><i class="fa fa-check"></i><b>8</b> Compound Arithmetic and Assignment</a></li>
<li class="chapter" data-level="9" data-path="higher-order-functions.html"><a href="higher-order-functions.html"><i class="fa fa-check"></i><b>9</b> Higher-Order Functions</a></li>
<li><a href="discrete-distributions.html#discrete-distributions"><i style="font-size: 110%; color:#990017;">Discrete Distributions</i></a></li>
<li class="chapter" data-level="10" data-path="conventions-for-probability-functions.html"><a href="conventions-for-probability-functions.html"><i class="fa fa-check"></i><b>10</b> Conventions for Probability Functions</a></li>
<li class="chapter" data-level="11" data-path="binary-distributions.html"><a href="binary-distributions.html"><i class="fa fa-check"></i><b>11</b> Binary Distributions</a></li>
<li class="chapter" data-level="12" data-path="bounded-discrete-distributions.html"><a href="bounded-discrete-distributions.html"><i class="fa fa-check"></i><b>12</b> Bounded Discrete Distributions</a></li>
<li class="chapter" data-level="13" data-path="unbounded-discrete-distributions.html"><a href="unbounded-discrete-distributions.html"><i class="fa fa-check"></i><b>13</b> Unbounded Discrete Distributions</a></li>
<li class="chapter" data-level="14" data-path="multivariate-discrete-distributions.html"><a href="multivariate-discrete-distributions.html"><i class="fa fa-check"></i><b>14</b> Multivariate Discrete Distributions</a></li>
<li><a href="continuous-distributions.html#continuous-distributions"><i style="font-size: 110%; color:#990017;">Continuous Distributions</i></a></li>
<li class="chapter" data-level="15" data-path="unbounded-continuous-distributions.html"><a href="unbounded-continuous-distributions.html"><i class="fa fa-check"></i><b>15</b> Unbounded Continuous Distributions</a></li>
<li class="chapter" data-level="16" data-path="positive-continuous-distributions.html"><a href="positive-continuous-distributions.html"><i class="fa fa-check"></i><b>16</b> Positive Continuous Distributions</a></li>
<li class="chapter" data-level="17" data-path="non-negative-continuous-distributions.html"><a href="non-negative-continuous-distributions.html"><i class="fa fa-check"></i><b>17</b> Non-negative Continuous Distributions</a></li>
<li class="chapter" data-level="18" data-path="positive-lower-bounded-probabilities.html"><a href="positive-lower-bounded-probabilities.html"><i class="fa fa-check"></i><b>18</b> Positive Lower-Bounded Probabilities</a></li>
<li class="chapter" data-level="19" data-path="continuous-distributions-on-0-1.html"><a href="continuous-distributions-on-0-1.html"><i class="fa fa-check"></i><b>19</b> Continuous Distributions on [0, 1]</a></li>
<li class="chapter" data-level="20" data-path="circular-distributions.html"><a href="circular-distributions.html"><i class="fa fa-check"></i><b>20</b> Circular Distributions</a></li>
<li class="chapter" data-level="21" data-path="bounded-continuous-probabilities.html"><a href="bounded-continuous-probabilities.html"><i class="fa fa-check"></i><b>21</b> Bounded Continuous Probabilities</a></li>
<li class="chapter" data-level="22" data-path="distributions-over-unbounded-vectors.html"><a href="distributions-over-unbounded-vectors.html"><i class="fa fa-check"></i><b>22</b> Distributions over Unbounded Vectors</a></li>
<li class="chapter" data-level="23" data-path="simplex-distributions.html"><a href="simplex-distributions.html"><i class="fa fa-check"></i><b>23</b> Simplex Distributions</a></li>
<li class="chapter" data-level="24" data-path="correlation-matrix-distributions.html"><a href="correlation-matrix-distributions.html"><i class="fa fa-check"></i><b>24</b> Correlation Matrix Distributions</a></li>
<li class="chapter" data-level="25" data-path="covariance-matrix-distributions.html"><a href="covariance-matrix-distributions.html"><i class="fa fa-check"></i><b>25</b> Covariance Matrix Distributions</a></li>
<li><a href="appendix.html#appendix"><i style="font-size: 110%; color:#990017;">Appendix</i></a></li>
<li class="chapter" data-level="26" data-path="math-functions.html"><a href="math-functions.html"><i class="fa fa-check"></i><b>26</b> Mathematical Functions</a></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan Functions Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dirichlet-distribution" class="section level2">
<h2><span class="header-section-number">23.1</span> Dirichlet Distribution</h2>
<div id="probability-density-function-31" class="section level3">
<h3><span class="header-section-number">23.1.1</span> Probability Density Function</h3>
<p>If <span class="math inline">\(K \in \mathbb{N}\)</span> and <span class="math inline">\(\alpha \in (\mathbb{R}^+)^{K}\)</span>, then for
<span class="math inline">\(\theta \in \text{$K$-simplex}\)</span>, <span class="math display">\[ \text{Dirichlet}(\theta|\alpha) =
\frac{\Gamma \! \left( \sum_{k=1}^K \alpha_k \right)}
{\prod_{k=1}^K \Gamma(\alpha_k)} \ \prod_{k=1}^K \theta_k^{\alpha_k -
1} . \]</span></p>
<p><em><strong>Warning:</strong></em> If any of the components of <span class="math inline">\(\theta\)</span> satisfies
<span class="math inline">\(\theta_i = 0\)</span> or <span class="math inline">\(\theta_i = 1\)</span>, then the probability is 0 and the
log probability is <span class="math inline">\(-\infty\)</span>. Similarly, the distribution requires
strictly positive parameters, with <span class="math inline">\(\alpha_i &gt; 0\)</span> for each <span class="math inline">\(i\)</span>.</p>
</div>
<div id="meaning-of-dirichlet-parameters" class="section level3">
<h3><span class="header-section-number">23.1.2</span> Meaning of Dirichlet Parameters</h3>
<p>A symmetric Dirichlet prior is <span class="math inline">\([\alpha, \ldots, \alpha]^{\top}\)</span>. To
code this in Stan,</p>
<pre><code> data {
   int&lt;lower = 1&gt; K;
   real&lt;lower = 0&gt; alpha;
 }
 generated quantities {
   vector[K] theta = dirichlet_rng(rep_vector(alpha, K));
 }</code></pre>
<p>Taking <span class="math inline">\(K = 10\)</span>, here are the first five draws for <span class="math inline">\(\alpha = 0.001\)</span>.
For <span class="math inline">\(\alpha = 1\)</span>, the distribution is uniform over simplexes.</p>
<pre><code> 1) 0.17 0.05 0.07 0.17 0.03 0.13 0.03 0.03 0.27 0.05
 2) 0.08 0.02 0.12 0.07 0.52 0.01 0.07 0.04 0.01 0.06
 3) 0.02 0.03 0.22 0.29 0.17 0.10 0.09 0.00 0.05 0.03
 4) 0.04 0.03 0.21 0.13 0.04 0.01 0.10 0.04 0.22 0.18
 5) 0.11 0.22 0.02 0.01 0.06 0.18 0.33 0.04 0.01 0.01</code></pre>
<p>That does not mean it’s uniform over the marginal probabilities of
each element. As the size of the simplex grows, the marginal draws
become more and more concentrated below (not around) <span class="math inline">\(1/K\)</span>. When one
component of the simplex is large, the others must all be relatively
small to compensate. For example, in a uniform distribution on
<span class="math inline">\(10\)</span>-simplexes, the probability that a component is greater than the
mean of <span class="math inline">\(1/10\)</span> is only 39%. Most of the posterior marginal
probability mass for each component is in the interval <span class="math inline">\((0, 0.1)\)</span>.</p>
<p>When the <span class="math inline">\(\alpha\)</span> value is small, the draws gravitate to the corners
of the simplex. Here are the first five draws for <span class="math inline">\(\alpha = 0.001\)</span>.</p>
<pre><code> 1) 3e-203 0e+00 2e-298 9e-106 1e+000 0e+00 0e+000 1e-047 0e+00 4e-279
 2) 1e+000 0e+00 5e-279 2e-014 1e-275 0e+00 3e-285 9e-147 0e+00 0e+000
 3) 1e-308 0e+00 1e-213 0e+000 0e+000 8e-75 0e+000 1e+000 4e-58 7e-112
 4) 6e-166 5e-65 3e-068 3e-147 0e+000 1e+00 3e-249 0e+000 0e+00 0e+000
 5) 2e-091 0e+00 0e+000 0e+000 1e-060 0e+00 4e-312 1e+000 0e+00 0e+000</code></pre>
<p>Each row denotes a draw. Each draw has a single value that rounds to
one and other values that are very close to zero or rounded down to
zero.</p>
<p>As <span class="math inline">\(\alpha\)</span> increases, the draws become increasingly uniform. For
<span class="math inline">\(\alpha = 1000\)</span>,</p>
<pre><code> 1) 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10
 2) 0.10 0.10 0.09 0.10 0.10 0.10 0.11 0.10 0.10 0.10
 3) 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10
 4) 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10
 5) 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10 0.10</code></pre>
</div>
<div id="sampling-statement-53" class="section level3">
<h3><span class="header-section-number">23.1.3</span> Sampling Statement</h3>
<p><code>theta ~</code> <strong><code>dirichlet</code></strong><code>(alpha)</code></p>
<p>Increment target log probability density with <code>dirichlet_lpdf( theta | alpha)</code>
dropping constant additive terms.
</p>
</div>
<div id="stan-functions-52" class="section level3">
<h3><span class="header-section-number">23.1.4</span> Stan Functions</h3>
<!-- real; dirichlet_lpdf; (vector theta | vector alpha); -->
<p></p>
<p><code>real</code> <strong><code>dirichlet_lpdf</code></strong><code>(vector theta | vector alpha)</code><br>
The log of the Dirichlet density for simplex theta given prior counts
(plus one) alpha</p>
<!-- vector; dirichlet_rng; (vector alpha); -->
<p></p>
<p><code>vector</code> <strong><code>dirichlet_rng</code></strong><code>(vector alpha)</code><br>
Generate a Dirichlet variate with prior counts (plus one) alpha; may
only be used in generated quantities block</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="simplex-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-matrix-distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
