<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stan Functions Reference</title>
  <meta name="description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Stan Functions Reference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stan Functions Reference" />
  
  <meta name="twitter:description" content="Reference for the functions defined in the Stan math library and available in the Stan programming language." />
  

<meta name="author" content="Stan Development Team">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="covariance.html">
<link rel="next" href="sort-functions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="../stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em">Stan Functions Reference</li>

<li class="divider"></li>
<li><a href="index.html#overview"><i style="font-size: 110%; padding:1.5em 0 0 0; color:#990017;">Overview</i></a></li>
<li><a href="built-in-functions.html#built-in-functions"><i style="font-size: 110%; color:#990017;">Built-In Functions</i></a></li>
<li class="chapter" data-level="1" data-path="void-functions.html"><a href="void-functions.html"><i class="fa fa-check"></i><b>1</b> Void Functions</a></li>
<li class="chapter" data-level="2" data-path="integer-valued-basic-functions.html"><a href="integer-valued-basic-functions.html"><i class="fa fa-check"></i><b>2</b> Integer-Valued Basic Functions</a></li>
<li class="chapter" data-level="3" data-path="real-valued-basic-functions.html"><a href="real-valued-basic-functions.html"><i class="fa fa-check"></i><b>3</b> Real-Valued Basic Functions</a></li>
<li class="chapter" data-level="4" data-path="array-operations.html"><a href="array-operations.html"><i class="fa fa-check"></i><b>4</b> Array Operations</a></li>
<li class="chapter" data-level="5" data-path="matrix-operations.html"><a href="matrix-operations.html"><i class="fa fa-check"></i><b>5</b> Matrix Operations</a></li>
<li class="chapter" data-level="6" data-path="sparse-matrices.html"><a href="sparse-matrices.html"><i class="fa fa-check"></i><b>6</b> Sparse Matrix Operations</a></li>
<li class="chapter" data-level="7" data-path="mixed-operations.html"><a href="mixed-operations.html"><i class="fa fa-check"></i><b>7</b> Mixed Operations</a></li>
<li class="chapter" data-level="8" data-path="compound-arithmetic-and-assignment.html"><a href="compound-arithmetic-and-assignment.html"><i class="fa fa-check"></i><b>8</b> Compound Arithmetic and Assignment</a></li>
<li class="chapter" data-level="9" data-path="higher-order-functions.html"><a href="higher-order-functions.html"><i class="fa fa-check"></i><b>9</b> Higher-Order Functions</a></li>
<li><a href="discrete-distributions.html#discrete-distributions"><i style="font-size: 110%; color:#990017;">Discrete Distributions</i></a></li>
<li class="chapter" data-level="10" data-path="conventions-for-probability-functions.html"><a href="conventions-for-probability-functions.html"><i class="fa fa-check"></i><b>10</b> Conventions for Probability Functions</a></li>
<li class="chapter" data-level="11" data-path="binary-distributions.html"><a href="binary-distributions.html"><i class="fa fa-check"></i><b>11</b> Binary Distributions</a></li>
<li class="chapter" data-level="12" data-path="bounded-discrete-distributions.html"><a href="bounded-discrete-distributions.html"><i class="fa fa-check"></i><b>12</b> Bounded Discrete Distributions</a></li>
<li class="chapter" data-level="13" data-path="unbounded-discrete-distributions.html"><a href="unbounded-discrete-distributions.html"><i class="fa fa-check"></i><b>13</b> Unbounded Discrete Distributions</a></li>
<li class="chapter" data-level="14" data-path="multivariate-discrete-distributions.html"><a href="multivariate-discrete-distributions.html"><i class="fa fa-check"></i><b>14</b> Multivariate Discrete Distributions</a></li>
<li><a href="continuous-distributions.html#continuous-distributions"><i style="font-size: 110%; color:#990017;">Continuous Distributions</i></a></li>
<li class="chapter" data-level="15" data-path="unbounded-continuous-distributions.html"><a href="unbounded-continuous-distributions.html"><i class="fa fa-check"></i><b>15</b> Unbounded Continuous Distributions</a></li>
<li class="chapter" data-level="16" data-path="positive-continuous-distributions.html"><a href="positive-continuous-distributions.html"><i class="fa fa-check"></i><b>16</b> Positive Continuous Distributions</a></li>
<li class="chapter" data-level="17" data-path="non-negative-continuous-distributions.html"><a href="non-negative-continuous-distributions.html"><i class="fa fa-check"></i><b>17</b> Non-negative Continuous Distributions</a></li>
<li class="chapter" data-level="18" data-path="positive-lower-bounded-probabilities.html"><a href="positive-lower-bounded-probabilities.html"><i class="fa fa-check"></i><b>18</b> Positive Lower-Bounded Probabilities</a></li>
<li class="chapter" data-level="19" data-path="continuous-distributions-on-0-1.html"><a href="continuous-distributions-on-0-1.html"><i class="fa fa-check"></i><b>19</b> Continuous Distributions on [0, 1]</a></li>
<li class="chapter" data-level="20" data-path="circular-distributions.html"><a href="circular-distributions.html"><i class="fa fa-check"></i><b>20</b> Circular Distributions</a></li>
<li class="chapter" data-level="21" data-path="bounded-continuous-probabilities.html"><a href="bounded-continuous-probabilities.html"><i class="fa fa-check"></i><b>21</b> Bounded Continuous Probabilities</a></li>
<li class="chapter" data-level="22" data-path="distributions-over-unbounded-vectors.html"><a href="distributions-over-unbounded-vectors.html"><i class="fa fa-check"></i><b>22</b> Distributions over Unbounded Vectors</a></li>
<li class="chapter" data-level="23" data-path="simplex-distributions.html"><a href="simplex-distributions.html"><i class="fa fa-check"></i><b>23</b> Simplex Distributions</a></li>
<li class="chapter" data-level="24" data-path="correlation-matrix-distributions.html"><a href="correlation-matrix-distributions.html"><i class="fa fa-check"></i><b>24</b> Correlation Matrix Distributions</a></li>
<li class="chapter" data-level="25" data-path="covariance-matrix-distributions.html"><a href="covariance-matrix-distributions.html"><i class="fa fa-check"></i><b>25</b> Covariance Matrix Distributions</a></li>
<li><a href="appendix.html#appendix"><i style="font-size: 110%; color:#990017;">Appendix</i></a></li>
<li class="chapter" data-level="26" data-path="math-functions.html"><a href="math-functions.html"><i class="fa fa-check"></i><b>26</b> Mathematical Functions</a></li>
<li><a href="references.html#references"><i style="font-size: 110%; color:#990017;">References</i></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stan Functions Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-algebra-functions-and-solvers" class="section level2">
<h2><span class="header-section-number">5.13</span> Linear Algebra Functions and Solvers</h2>
<div id="matrix-division-operators-and-functions" class="section level3">
<h3><span class="header-section-number">5.13.1</span> Matrix Division Operators and Functions</h3>
<p>In general, it is much more efficient and also more arithmetically
stable to use matrix division than to multiply by an inverse. There
are specialized forms for lower triangular matrices and for symmetric,
positive-definite matrices.</p>
<div id="matrix-division-operators" class="section level4">
<h4><span class="header-section-number">5.13.1.1</span> Matrix division operators</h4>
<!-- row_vector; operator/; (row_vector b, matrix A); -->
<p></p>
<p><code>row_vector</code> <strong><code>operator/</code></strong><code>(row_vector b, matrix A)</code><br>
The right division of b by A; equivalently <code>b * inverse(A)</code></p>
<!-- matrix; operator/; (matrix B, matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>operator/</code></strong><code>(matrix B, matrix A)</code><br>
The right division of B by A; equivalently <code>B * inverse(A)</code></p>
<!-- vector; operator\; (matrix A, vector b); -->
<p></p>
<p><code>vector</code> <strong><code>operator\</code></strong><code>(matrix A, vector b)</code><br></p>
<!-- matrix; operator\; (matrix A, matrix B); -->
<p></p>
<p><code>matrix</code> <strong><code>operator\</code></strong><code>(matrix A, matrix B)</code><br></p>
</div>
<div id="lower-triangular-matrix-division-functions" class="section level4">
<h4><span class="header-section-number">5.13.1.2</span> Lower-triangular matrix division functions</h4>
<p>There are four division functions which use lower triangular views of
a matrix. The lower triangular view of a matrix <span class="math inline">\(\text{tri}(A)\)</span> is
used in the definitions and defined by <span class="math display">\[ \text{tri}(A)[m,n] = \left\{
\begin{array}{ll} A[m,n] &amp; \text{if } m \geq n, \text{ and} \\[4pt] 0
&amp; \text{otherwise}. \end{array} \right. \]</span> When a lower triangular
view of a matrix is used, the elements above the diagonal are ignored.</p>
<!-- vector; mdivide_left_tri_low; (matrix A, vector b); -->
<p></p>
<p><code>vector</code> <strong><code>mdivide_left_tri_low</code></strong><code>(matrix A, vector b)</code><br>
The left division of b by a lower-triangular view of A; algebraically
equivalent to the less efficient and stable form <code>inverse(tri(A)) * b</code>, where <code>tri(A)</code> is the lower-triangular portion of A with the
above-diagonal entries set to zero.</p>
<!-- matrix; mdivide_left_tri_low; (matrix A, matrix B); -->
<p></p>
<p><code>matrix</code> <strong><code>mdivide_left_tri_low</code></strong><code>(matrix A, matrix B)</code><br>
The left division of B by a triangular view of A; algebraically
equivalent to the less efficient and stable form <code>inverse(tri(A)) * B</code>, where <code>tri(A)</code> is the lower-triangular portion of A with the
above-diagonal entries set to zero.</p>
<!-- row_vector; mdivide_right_tri_low; (row_vector b, matrix A); -->
<p></p>
<p><code>row_vector</code> <strong><code>mdivide_right_tri_low</code></strong><code>(row_vector b, matrix A)</code><br>
The right division of b by a triangular view of A; algebraically
equivalent to the less efficient and stable form <code>b * inverse(tri(A))</code>, where <code>tri(A)</code> is the lower-triangular portion of A
with the above-diagonal entries set to zero.</p>
<!-- matrix; mdivide_right_tri_low; (matrix B, matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>mdivide_right_tri_low</code></strong><code>(matrix B, matrix A)</code><br>
The right division of B by a triangular view of A; algebraically
equivalent to the less efficient and stable form <code>B * inverse(tri(A))</code>, where <code>tri(A)</code> is the lower-triangular portion of A
with the above-diagonal entries set to zero.</p>
</div>
</div>
<div id="symmetric-positive-definite-matrix-division-functions" class="section level3">
<h3><span class="header-section-number">5.13.2</span> Symmetric positive-definite matrix division functions</h3>
<p>There are four division functions which are specialized for efficiency
and stability for symmetric positive-definite matrix dividends. If
the matrix dividend argument is not symmetric and positive definite,
these will reject and print warnings.</p>
<!-- matrix; mdivide_left_spd; (matrix A, vector b); -->
<p></p>
<p><code>matrix</code> <strong><code>mdivide_left_spd</code></strong><code>(matrix A, vector b)</code><br>
The left division of b by the symmetric, positive-definite matrix A;
algebraically equivalent to the less efficient and stable form
<code>inverse(A) * b</code>.</p>
<!-- vector; mdivide_left_spd; (matrix A, matrix B); -->
<p></p>
<p><code>vector</code> <strong><code>mdivide_left_spd</code></strong><code>(matrix A, matrix B)</code><br>
The left division of B by the symmetric, positive-definite matrix A;
algebraically equivalent to the less efficient and stable form
<code>inverse(A) * B</code>.</p>
<!-- row_vector; mdivide_right_spd; (row_vector b, matrix A); -->
<p></p>
<p><code>row_vector</code> <strong><code>mdivide_right_spd</code></strong><code>(row_vector b, matrix A)</code><br>
The right division of b by the symmetric, positive-definite matrix A;
algebraically equivalent to the less efficient and stable form <code>b * inverse(A)</code>.</p>
<!-- matrix; mdivide_right_spd; (matrix B, matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>mdivide_right_spd</code></strong><code>(matrix B, matrix A)</code><br>
The right division of B by the symmetric, positive-definite matrix A;
algebraically equivalent to the less efficient and stable form <code>B * inverse(A)</code>.</p>
</div>
<div id="matrix-exponential" class="section level3">
<h3><span class="header-section-number">5.13.3</span> Matrix Exponential</h3>
<p>The exponential of the matrix <span class="math inline">\(A\)</span> is formally defined by the
convergent power series: <span class="math display">\[ e^A = \sum_{n=0}^{\infty} \dfrac{A^n}{n!}
\]</span></p>
<!-- matrix; matrix_exp; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>matrix_exp</code></strong><code>(matrix A)</code><br>
The matrix exponential of A</p>
<!-- matrix; matrix_exp_multiply; (matrix A, matrix B); -->
<p></p>
<p><code>matrix</code> <strong><code>matrix_exp_multiply</code></strong><code>(matrix A, matrix B)</code><br>
The multiplication of matrix exponential of A and matrix B;
algebraically equivalent to the less efficient form <code>matrix_exp(A) * B</code>.</p>
<!-- matrix; scale_matrix_exp_multiply; (real t, matrix A, matrix B); -->
<p></p>
<p><code>matrix</code> <strong><code>scale_matrix_exp_multiply</code></strong><code>(real t, matrix A, matrix B)</code><br>
The multiplication of matrix exponential of tA and matrix B;
algebraically equivalent to the less efficient form <code>matrix_exp(tA) * B</code>.</p>
</div>
<div id="linear-algebra-functions" class="section level3">
<h3><span class="header-section-number">5.13.4</span> Linear Algebra Functions</h3>
<div id="trace" class="section level4">
<h4><span class="header-section-number">5.13.4.1</span> Trace</h4>
<!-- real; trace; (matrix A); -->
<p></p>
<p><code>real</code> <strong><code>trace</code></strong><code>(matrix A)</code><br>
The trace of A, or 0 if A is empty; A is not required to be diagonal</p>
</div>
<div id="determinants" class="section level4">
<h4><span class="header-section-number">5.13.4.2</span> Determinants</h4>
<!-- real; determinant; (matrix A); -->
<p></p>
<p><code>real</code> <strong><code>determinant</code></strong><code>(matrix A)</code><br>
The determinant of A</p>
<!-- real; log_determinant; (matrix A); -->
<p></p>
<p><code>real</code> <strong><code>log_determinant</code></strong><code>(matrix A)</code><br>
The log of the absolute value of the determinant of A</p>
</div>
<div id="inverses" class="section level4">
<h4><span class="header-section-number">5.13.4.3</span> Inverses</h4>
<p>It is almost never a good idea to use matrix inverses directly because
they are both inefficient and arithmetically unstable compared to the
alternatives. Rather than inverting a matrix <code>m</code> and post-multiplying
by a vector or matrix <code>a</code>, as in <code>inverse(m) * a</code>, it is better to
code this using matrix division, as in <code>m \ a</code>. The
pre-multiplication case is similar, with <code>b * inverse(m)</code> being more
efficiently coded as as <code>b / m</code>. There are also useful special cases
for triangular and symmetric, positive-definite matrices that use more
efficient solvers.</p>
<p><em><strong>Warning:</strong></em> The function <code>inv(m)</code> is the elementwise inverse
function, which returns <code>1 / m[i, j]</code> for each element.</p>
<!-- matrix; inverse; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>inverse</code></strong><code>(matrix A)</code><br>
The inverse of A</p>
<!-- matrix; inverse_spd; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>inverse_spd</code></strong><code>(matrix A)</code><br>
The inverse of A where A is symmetric, positive definite. This version
is faster and more arithmetically stable when the input is symmetric
and positive definite.</p>
</div>
<div id="eigendecomposition" class="section level4">
<h4><span class="header-section-number">5.13.4.4</span> Eigendecomposition</h4>
<!-- vector; eigenvalues_sym; (matrix A); -->
<p></p>
<p><code>vector</code> <strong><code>eigenvalues_sym</code></strong><code>(matrix A)</code><br>
The vector of eigenvalues of a symmetric matrix A in ascending order</p>
<!-- matrix; eigenvectors_sym; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>eigenvectors_sym</code></strong><code>(matrix A)</code><br>
The matrix with the (column) eigenvectors of symmetric matrix A in the
same order as returned by the function <code>eigenvalues_sym</code></p>
<p>Because multiplying an eigenvector by <span class="math inline">\(-1\)</span> results in an eigenvector,
eigenvectors returned by a decomposition are only identified up to a
sign change. In order to compare the eigenvectors produced by Stan’s
eigendecomposition to others, signs may need to be normalized in some
way, such as by fixing the sign of a component, or doing comparisons
allowing a multiplication by <span class="math inline">\(-1\)</span>.</p>
<p>The condition number of a symmetric matrix is defined to be the ratio
of the largest eigenvalue to the smallest eigenvalue. Large condition
numbers lead to difficulty in numerical algorithms such as computing
inverses, and thus known as “ill conditioned.” The ratio can even be
infinite in the case of singular matrices (i.e., those with
eigenvalues of 0).</p>
</div>
<div id="QR-decomposition" class="section level4">
<h4><span class="header-section-number">5.13.4.5</span> QR Decomposition</h4>
<!-- matrix; qr_thin_Q; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>qr_thin_Q</code></strong><code>(matrix A)</code><br>
The orthogonal matrix in the thin QR decomposition of A, which implies
that the resulting matrix has the same dimensions as A</p>
<!-- matrix; qr_thin_R; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>qr_thin_R</code></strong><code>(matrix A)</code><br>
The upper triangular matrix in the thin QR decomposition of A, which
implies that the resulting matrix is square with the same number of
columns as A</p>
<!-- matrix; qr_Q; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>qr_Q</code></strong><code>(matrix A)</code><br>
The orthogonal matrix in the fat QR decomposition of A, which implies
that the resulting matrix is square with the same number of rows as A</p>
<!-- matrix; qr_R; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>qr_R</code></strong><code>(matrix A)</code><br>
The upper trapezoidal matrix in the fat QR decomposition of A, which
implies that the resulting matrix will be square with the same number
of rows as A</p>
<p>The thin QR decomposition is always preferable because it will consume
much less memory when the input matrix is large than will the fat QR
decomposition. Both versions of the decomposition represent the input
matrix as <span class="math display">\[ A = Q \, R. \]</span> Multiplying a column of an orthogonal
matrix by <span class="math inline">\(-1\)</span> still results in an orthogonal matrix, and you can
multiply the corresponding row of the upper trapezoidal matrix by <span class="math inline">\(-1\)</span>
without changing the product. Thus, Stan adopts the normalization that
the diagonal elements of the upper trapezoidal matrix are strictly
positive and the columns of the orthogonal matrix are reflected if
necessary. Also, these QR decomposition algorithms do not utilize
pivoting and thus may be numerically unstable on input matrices that
have less than full rank.</p>
</div>
<div id="cholesky-decomposition" class="section level4">
<h4><span class="header-section-number">5.13.4.6</span> Cholesky Decomposition</h4>
<p>Every symmetric, positive-definite matrix (such as a correlation or
covariance matrix) has a Cholesky decomposition. If <span class="math inline">\(\Sigma\)</span> is a
symmetric, positive-definite matrix, its Cholesky decomposition is the
lower-triangular vector <span class="math inline">\(L\)</span> such that <span class="math display">\[ \Sigma = L \, L^{\top}. \]</span></p>
<!-- matrix; cholesky_decompose; (matrix A); -->
<p></p>
<p><code>matrix</code> <strong><code>cholesky_decompose</code></strong><code>(matrix A)</code><br>
The lower-triangular Cholesky factor of the symmetric
positive-definite matrix A</p>
</div>
<div id="singular-value-decomposition" class="section level4">
<h4><span class="header-section-number">5.13.4.7</span> Singular Value Decomposition</h4>
<p>Stan only provides functions for the singular values, not for the
singular vectors involved in a singular value decomposition (SVD).</p>
<!-- vector; singular_values; (matrix A); -->
<p></p>
<p><code>vector</code> <strong><code>singular_values</code></strong><code>(matrix A)</code><br>
The singular values of A in descending order</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="covariance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sort-functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
