<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 MCMC Sampling using Hamiltonian Monte Carlo | CmdStan User’s Guide</title>
  <meta name="description" content="CmdStan user’s guide." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="9 MCMC Sampling using Hamiltonian Monte Carlo | CmdStan User’s Guide" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/logo-tm.pdf" />
  <meta property="og:description" content="CmdStan user’s guide." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 MCMC Sampling using Hamiltonian Monte Carlo | CmdStan User’s Guide" />
  
  <meta name="twitter:description" content="CmdStan user’s guide." />
  <meta name="twitter:image" content="img/logo-tm.pdf" />

<meta name="author" content="Stan Development Team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="command-line-interface-overview.html"/>
<link rel="next" href="optimize-maximum-likelihood-estimation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="stan-manual.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style="font-size:110%; font-weight:400; font-family: Verdana, Helvetica, sans; line-height:1.4; margin: 0.5em 0 0 1em"><a href="https://mc-stan.org/docs/cmdstan-guide/index.html" style="color:#4183C4">CmdStan User's Guide</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction"><i style='font-size: 110%; color:#990017;'>Introduction</i></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Stan Home Page</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licensing"><i class="fa fa-check"></i>Licensing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#stan-documentation-users-guide-and-reference-manuals"><i class="fa fa-check"></i>Stan Documentation: User’s Guide and Reference Manuals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#benefits-of-cmdstan"><i class="fa fa-check"></i>Benefits of CmdStan</a></li>
</ul></li>
<li><a href="quickstart-guide.html#quickstart-guide"><i style='font-size: 110%; color:#990017;'>QuickStart Guide</i></a></li>
<li class="chapter" data-level="1" data-path="cmdstan-installation.html"><a href="cmdstan-installation.html"><i class="fa fa-check"></i><b>1</b> CmdStan Installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="cmdstan-installation.html"><a href="cmdstan-installation.html#gnu-make-utility"><i class="fa fa-check"></i><b>1.1</b> GNU-Make Utility</a></li>
<li class="chapter" data-level="1.2" data-path="cmdstan-installation.html"><a href="cmdstan-installation.html#building-cmdstan"><i class="fa fa-check"></i><b>1.2</b> Building CmdStan</a></li>
<li class="chapter" data-level="1.3" data-path="cmdstan-installation.html"><a href="cmdstan-installation.html#git-clone.section"><i class="fa fa-check"></i><b>1.3</b> Clone the GitHub CmdStan Repository</a></li>
<li class="chapter" data-level="1.4" data-path="cmdstan-installation.html"><a href="cmdstan-installation.html#trouble-shooting-the-installation"><i class="fa fa-check"></i><b>1.4</b> Trouble-shooting the installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-model-and-data.html"><a href="example-model-and-data.html"><i class="fa fa-check"></i><b>2</b> Example Model and Data</a></li>
<li class="chapter" data-level="3" data-path="compiling-a-stan-program.html"><a href="compiling-a-stan-program.html"><i class="fa fa-check"></i><b>3</b> Compiling a Stan Program</a>
<ul>
<li class="chapter" data-level="3.1" data-path="compiling-a-stan-program.html"><a href="compiling-a-stan-program.html#invoking-the-make-utility"><i class="fa fa-check"></i><b>3.1</b> Invoking the Make Utility</a></li>
<li class="chapter" data-level="3.2" data-path="compiling-a-stan-program.html"><a href="compiling-a-stan-program.html#dependencies"><i class="fa fa-check"></i><b>3.2</b> Dependencies</a></li>
<li class="chapter" data-level="3.3" data-path="compiling-a-stan-program.html"><a href="compiling-a-stan-program.html#compiler-errors"><i class="fa fa-check"></i><b>3.3</b> Compiler Errors</a></li>
<li class="chapter" data-level="3.4" data-path="compiling-a-stan-program.html"><a href="compiling-a-stan-program.html#troubleshooting"><i class="fa fa-check"></i><b>3.4</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mcmc-sampling.html"><a href="mcmc-sampling.html"><i class="fa fa-check"></i><b>4</b> MCMC Sampling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mcmc-sampling.html"><a href="mcmc-sampling.html#running-the-sampler"><i class="fa fa-check"></i><b>4.1</b> Running the Sampler</a></li>
<li class="chapter" data-level="4.2" data-path="mcmc-sampling.html"><a href="mcmc-sampling.html#running-multiple-chains"><i class="fa fa-check"></i><b>4.2</b> Running Multiple Chains</a></li>
<li class="chapter" data-level="4.3" data-path="mcmc-sampling.html"><a href="mcmc-sampling.html#stan-csv-output-file"><i class="fa fa-check"></i><b>4.3</b> Stan CSV Output File</a></li>
<li class="chapter" data-level="4.4" data-path="mcmc-sampling.html"><a href="mcmc-sampling.html#summarizing-sampler-outputs-with-stansummary"><i class="fa fa-check"></i><b>4.4</b> Summarizing Sampler Output(s) with <code>stansummary</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>5</b> Optimization</a></li>
<li class="chapter" data-level="6" data-path="variational-inference.html"><a href="variational-inference.html"><i class="fa fa-check"></i><b>6</b> Variational Inference</a></li>
<li class="chapter" data-level="7" data-path="generating-quantities-of-interest-from-a-fitted-model.html"><a href="generating-quantities-of-interest-from-a-fitted-model.html"><i class="fa fa-check"></i><b>7</b> Generating Quantities of Interest from a Fitted Model</a></li>
<li><a href="cmdstan-reference.html#cmdstan-reference"><i style='font-size: 110%; color:#990017;'>CmdStan Reference</i></a></li>
<li class="chapter" data-level="8" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html"><i class="fa fa-check"></i><b>8</b> Command-Line Interface Overview</a>
<ul>
<li class="chapter" data-level="8.1" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#input-data-argument"><i class="fa fa-check"></i><b>8.1</b> Input Data Argument</a></li>
<li class="chapter" data-level="8.2" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#output-control-arguments"><i class="fa fa-check"></i><b>8.2</b> Output Control Arguments</a></li>
<li class="chapter" data-level="8.3" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#initialize-model-parameters-argument"><i class="fa fa-check"></i><b>8.3</b> Initialize Model Parameters Argument</a></li>
<li class="chapter" data-level="8.4" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#random-number-generator-arguments"><i class="fa fa-check"></i><b>8.4</b> Random Number Generator Arguments</a></li>
<li class="chapter" data-level="8.5" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#chain-identifier-argument-id"><i class="fa fa-check"></i><b>8.5</b> Chain Identifier Argument: <code>id</code></a></li>
<li class="chapter" data-level="8.6" data-path="command-line-interface-overview.html"><a href="command-line-interface-overview.html#command-line-help"><i class="fa fa-check"></i><b>8.6</b> Command Line Help</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> MCMC Sampling using Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#iterations"><i class="fa fa-check"></i><b>9.1</b> Iterations</a></li>
<li class="chapter" data-level="9.2" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#adaptation"><i class="fa fa-check"></i><b>9.2</b> Adaptation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#step-size-optimization-configuration"><i class="fa fa-check"></i><b>9.2.1</b> step size optimization configuration</a></li>
<li class="chapter" data-level="9.2.2" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#warmup-schedule-configuration"><i class="fa fa-check"></i><b>9.2.2</b> Warmup schedule configuration</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#algorithm"><i class="fa fa-check"></i><b>9.3</b> Algorithm</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#hmc-sampler-engines"><i class="fa fa-check"></i><b>9.3.1</b> HMC sampler engines</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mcmc-sampling-using-hamiltonian-monte-carlo.html"><a href="mcmc-sampling-using-hamiltonian-monte-carlo.html#examples"><i class="fa fa-check"></i><b>9.4</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="optimize-maximum-likelihood-estimation.html"><a href="optimize-maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>10</b> <code>optimize</code>: Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="11" data-path="variational-method-configuration-command-line-options.html"><a href="variational-method-configuration-command-line-options.html"><i class="fa fa-check"></i><b>11</b> <code>variational</code> Method Configuration Command-Line Options</a></li>
<li class="chapter" data-level="12" data-path="generate-quantities-new-quantities-of-interest-from-existing-sample.html"><a href="generate-quantities-new-quantities-of-interest-from-existing-sample.html"><i class="fa fa-check"></i><b>12</b> <code>generate_quantities</code>: New Quantities of Interest From Existing Sample</a></li>
<li class="chapter" data-level="13" data-path="diagnosing-hmc-by-comparison-of-gradients.html"><a href="diagnosing-hmc-by-comparison-of-gradients.html"><i class="fa fa-check"></i><b>13</b> Diagnosing HMC by Comparison of Gradients</a></li>
<li><a href="cmdstan-tools.html#cmdstan-tools"><i style='font-size: 110%; color:#990017;'>CmdStan Tools</i></a></li>
<li class="chapter" data-level="14" data-path="stanc.html"><a href="stanc.html"><i class="fa fa-check"></i><b>14</b> <code>stanc</code>: Translating Stan to C++</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stanc.html"><a href="stanc.html#instantiating-the-stanc-binary"><i class="fa fa-check"></i><b>14.1</b> Instantiating the <code>stanc</code> Binary</a></li>
<li class="chapter" data-level="14.2" data-path="stanc.html"><a href="stanc.html#the-stan-compiler-program"><i class="fa fa-check"></i><b>14.2</b> The Stan Compiler Program</a></li>
<li class="chapter" data-level="14.3" data-path="stanc.html"><a href="stanc.html#command-line-options-for-stanc3"><i class="fa fa-check"></i><b>14.3</b> Command-Line Options for stanc3</a></li>
<li class="chapter" data-level="14.4" data-path="stanc.html"><a href="stanc.html#command-line-options-for-stanc2"><i class="fa fa-check"></i><b>14.4</b> Command-Line Options for stanc2</a></li>
<li class="chapter" data-level="14.5" data-path="stanc.html"><a href="stanc.html#using-external-c-code"><i class="fa fa-check"></i><b>14.5</b> Using External C++ Code</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="stansummary.html"><a href="stansummary.html"><i class="fa fa-check"></i><b>15</b> <code>stansummary</code>: MCMC Output Analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="stansummary.html"><a href="stansummary.html#building-the-stansummary-command"><i class="fa fa-check"></i><b>15.1</b> Building the stansummary Command</a></li>
<li class="chapter" data-level="15.2" data-path="stansummary.html"><a href="stansummary.html#running-the-stansummary-command"><i class="fa fa-check"></i><b>15.2</b> Running the stansummary Command</a></li>
<li class="chapter" data-level="15.3" data-path="stansummary.html"><a href="stansummary.html#command-line-options"><i class="fa fa-check"></i><b>15.3</b> Command-line Options</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="diagnose.html"><a href="diagnose.html"><i class="fa fa-check"></i><b>16</b> <code>diagnose</code>: Diagnosing Biased Hamiltonian Monte Carlo Inferences</a>
<ul>
<li class="chapter" data-level="16.1" data-path="diagnose.html"><a href="diagnose.html#building-the-diagnose-command"><i class="fa fa-check"></i><b>16.1</b> Building the diagnose Command</a></li>
<li class="chapter" data-level="16.2" data-path="diagnose.html"><a href="diagnose.html#running-the-diagnose-command"><i class="fa fa-check"></i><b>16.2</b> Running the diagnose Command</a></li>
<li class="chapter" data-level="16.3" data-path="diagnose.html"><a href="diagnose.html#diagnose-warnings-and-recommendations"><i class="fa fa-check"></i><b>16.3</b> <code>diagnose</code> Warnings and Recommendations</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="diagnose.html"><a href="diagnose.html#divergent-transitions-after-warmup"><i class="fa fa-check"></i><b>16.3.1</b> Divergent transitions after warmup</a></li>
<li class="chapter" data-level="16.3.2" data-path="diagnose.html"><a href="diagnose.html#maximum-treedepth-exceeded"><i class="fa fa-check"></i><b>16.3.2</b> Maximum treedepth exceeded</a></li>
<li class="chapter" data-level="16.3.3" data-path="diagnose.html"><a href="diagnose.html#low-e-bfmi-values---sampler-transitions-hmc-potential-energy."><i class="fa fa-check"></i><b>16.3.3</b> Low E-BFMI values - sampler transitions HMC potential energy.</a></li>
<li class="chapter" data-level="16.3.4" data-path="diagnose.html"><a href="diagnose.html#low-effective-sample-sizes"><i class="fa fa-check"></i><b>16.3.4</b> Low effective sample sizes</a></li>
<li class="chapter" data-level="16.3.5" data-path="diagnose.html"><a href="diagnose.html#high-hatr"><i class="fa fa-check"></i><b>16.3.5</b> High <span class="math inline">\(\hat{R}\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="print-deprecated-mcmc-output-analysis.html"><a href="print-deprecated-mcmc-output-analysis.html"><i class="fa fa-check"></i><b>17</b> <code>print</code> (deprecated): MCMC Output Analysis</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CmdStan User’s Guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mcmc-sampling-using-hamiltonian-monte-carlo" class="section level1">
<h1><span class="header-section-number">9</span> MCMC Sampling using Hamiltonian Monte Carlo</h1>
<p>The <code>sample</code> method provides Bayesian inference over the model conditioned on data
using Hamiltonian Monte Carlo (HMC) sampling. By default, the inference engine used is
the No-U-Turn sampler (NUTS), an adaptive form of Hamiltonian Monte Carlo sampling.
For details on HMC and NUTS, see the Stan Reference Manual chapter on
<a href="https://mc-stan.org/docs/reference-manual/hmc-chapter.html">MCMC Sampling</a>.</p>
<p>The full set of configuration options available for the <code>sample</code> method is
reported at the beginning of the sampler output file as csv comments.
When the example model <code>bernoulli.stan</code> is run via the command line
with all default arguments,
the resulting Stan csv file header comments show the complete set
of default configuration options:</p>
<pre><code># model = bernoulli_model
# method = sample (Default)
#   sample
#     num_samples = 1000 (Default)
#     num_warmup = 1000 (Default)
#     save_warmup = 0 (Default)
#     thin = 1 (Default)
#     adapt
#       engaged = 1 (Default)
#       gamma = 0.05 (Default)
#       delta = 0.8 (Default)
#       kappa = 0.75 (Default)
#       t0 = 10 (Default)
#       init_buffer = 75 (Default)
#       term_buffer = 50 (Default)
#       window = 25 (Default)
#     algorithm = hmc (Default)
#       hmc
#         engine = nuts (Default)
#           nuts
#             max_depth = 10 (Default)
#         metric = diag_e (Default)
#         metric_file =  (Default)
#         stepsize = 1 (Default)
#         stepsize_jitter = 0 (Default)</code></pre>
<div id="iterations" class="section level2">
<h2><span class="header-section-number">9.1</span> Iterations</h2>
<p>At every sampler iteration, the sampler returns a set of estimates
for all parameters and quantities of interest in the model.
During warmup, the NUTS algorithm adjusts the HMC algorithm parameters
<code>metric</code> and <code>stepsize</code> in order to efficiently sample from
<em>typical set</em>, the neighborhood substantial posterior probability mass
through which the Markov chain will travel in equilibrium.
After warmup, the fixed metric and stepsize are used to produce
a set of draws.</p>
<p>The following keyword-value arguments control the total number of iterations and
the number of draws written to the output file:</p>
<ul>
<li><code>num_samples</code></li>
<li><code>num_warmup</code></li>
<li><code>save_warmup</code></li>
<li><code>thin</code></li>
</ul>
</div>
<div id="adaptation" class="section level2">
<h2><span class="header-section-number">9.2</span> Adaptation</h2>
<p>The <code>adapt</code> keyword is used to specify non-default options for
the sampler adaptation schedule and settings.</p>
<p>Adaptation can be turned off by setting sub-argument <code>engaged</code> to value <span class="math inline">\(0\)</span>.
If <code>engaged=0</code>, no adaptation will be done, and all other adaptation sub-arguments will be ignored.
Since the default value is <code>engaged=1</code>, this keyword-value pair can be omitted from the command.</p>
<p>There are two sets of adaptation sub-arguments: step size optimization parameters and the warmup schedule.
These are described in detail in the Reference Manual section
<a href="https://mc-stan.org/docs/2_23/reference-manual/hmc-algorithm-parameters.html">Automatic Parameter Tuning</a>.</p>
<div id="step-size-optimization-configuration" class="section level3">
<h3><span class="header-section-number">9.2.1</span> step size optimization configuration</h3>
<p>The following keyword-value arguments control the settings used to optimize the step size:</p>
<ul>
<li><p><code>delta</code> - The target Metropolis acceptance rate. The default value is <span class="math inline">\(0.8\)</span>.
Its value must be strictly between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. Increasing the default value
forces the algorithm to use smaller step sizes. This can
improve sampling efficiency (effective sample size per iteration) at
the cost of increased iteration times. Raising the value of <code>delta</code>
will also allow some models that would otherwise get stuck to overcome
their blockages.</p></li>
<li><p><code>gamma</code> - Adaptation regularization scale.
Must be a positive real number, default value is <span class="math inline">\(0.05\)</span>.
This is a parameter of the Nesterov dual-averaging algorithm.
We recommend always using the default value.</p></li>
<li><p><code>gamma</code> - Adaptation relaxation exponent.
Must be a positive real number, default value is <span class="math inline">\(0.75\)</span>.
This is a parameter of the Nesterov dual-averaging algorithm.
We recommend always using the default value.</p></li>
<li><p><code>t_0</code> - Adaptation iteration offset.
Must be a positive real number, default value is <span class="math inline">\(10\)</span>.
This is a parameter of the Nesterov dual-averaging algorithm.
We recommend always using the default value.</p></li>
</ul>
</div>
<div id="warmup-schedule-configuration" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Warmup schedule configuration</h3>
<p>When adaptation is engaged, the warmup schedule is specified by sub-arguments,
all of which take positive integers as values:</p>
<ul>
<li><code>init_buffer</code> - The number of iterations spent tuning the step size at the outset of adaptation.</li>
<li><code>window</code> - The initial number of iterations devoted to tune the metric, will be doubled successively.</li>
<li><code>term_buffer</code> - The number of iterations used to re-tune the step size once the metric has been tuned.</li>
</ul>
<p>The specified values may be modified slightly in order to ensure alignment
between the warmup schedule and total number of warmup iterations.</p>
<p>The following figure is taken from the Stan Reference Manual,
where label “I” correspond to <code>init_buffer</code>, the initial “II” correponds to <code>window</code>,
and the final “III” corresponds to <code>term_buffer</code>:</p>
<p><strong>Warmup Epochs Figure.</strong> <a id="adaptation.figure"></a>
<em>Adaptation during warmup occurs in three stages: an initial fast
adaptation interval (I), a series of expanding slow adaptation
intervals (II), and a final fast adaptation interval (III). For HMC,
both the fast and slow intervals are used for adapting the step size,
while the slow intervals are used for learning the (co)variance
necessitated by the metric. Iteration numbering starts at 1 on the
left side of the figure and increases to the right.</em></p>
<p><img src="img/warmup-epochs.png" /></p>
</div>
</div>
<div id="algorithm" class="section level2">
<h2><span class="header-section-number">9.3</span> Algorithm</h2>
<p>The <code>algorithm</code> keyword-value pair specifies the algorithm used to generate the sample.
There are two possible values: <code>hmc</code>, which generates from an HMC-driven Markov chain;
and <code>fixed_param</code> which generates a new sample without changing the state of the Markov chain.
The default value is <code>algorithm=hmc</code>.</p>
<p>If a model doesn’t specify any parameters, as is the case for models which generate psuedo-data
via the transformed data and generated quantities blocks, then argument <code>algorithm=fixed_param</code>
is mandatory.</p>
<div id="hmc-sampler-engines" class="section level3">
<h3><span class="header-section-number">9.3.1</span> HMC sampler engines</h3>
<p>All HMC algorithms have three parameters:</p>
<ul>
<li>step size</li>
<li>metric</li>
<li>integration time - the number of steps taken along the Hamiltonian trajectory</li>
</ul>
<p>See the Stan Reference Manual section on
<a href="https://mc-stan.org/docs/reference-manual/hmc-algorithm-parameters.html">HMC algorithm parameters</a>
for further details.</p>
<p>CmdStan provides two HMC algorithm implementations, which are specified by keyword <code>engine</code> with
possible values:</p>
<ul>
<li><code>nuts</code> - the No-U-Turn Sampler which dynamically determines the optimal integration time.</li>
<li><code>static</code> - an HMC sampler which uses a user-specified integration time.</li>
</ul>
<p>The default value is <code>engine=nuts</code>.</p>
<div id="nuts-hmc-sampler" class="section level4">
<h4><span class="header-section-number">9.3.1.1</span> NUTS-HMC sampler</h4>
</div>
<div id="static-hmc-sampler" class="section level4">
<h4><span class="header-section-number">9.3.1.2</span> Static HMC sampler</h4>
</div>
</div>
</div>
<div id="examples" class="section level2">
<h2><span class="header-section-number">9.4</span> Examples</h2>
<p>Common sampler configurations.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="command-line-interface-overview.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimize-maximum-likelihood-estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true,
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
